import{$ as o,L as r,I as u}from"./DarkTheme-B0yFoytb.js";function $(l){let t={};if(Array.isArray(l))l.forEach(function(e){try{t={...t,...JSON.parse(sessionStorage.getItem(e))}}catch(s){console.error(s)}});else{const e=sessionStorage.getItem(l);if(e)try{t=JSON.parse(e)}catch(s){console.error(s)}}return t}function T(l){Object.keys(l).forEach(function(t){const e={};e[t]=l[t];try{sessionStorage.setItem(t,JSON.stringify(e))}catch(s){console.error(s)}})}class b{constructor(){this._url="https://build.Ovobot.com",this._cacheExpirationPeriod=3600*1e3}load(t,e,s){const a=`${t}_Data`,i=`${t}_LastUpdate`,n=$([i,a]),h=o.now(),d=n[a],f=n[i],p=()=>{d&&r(u.getMessage("buildServerUsingCached",[t])),e(d)};!d||!f||h-f>this._cacheExpirationPeriod?o.get(t,function(c){const g={};g[a]=c,g[i]=o.now(),T(g),e(c)}).fail(c=>{r(u.getMessage("buildServerFailure",[t,`HTTP ${c.status}`])),s!==void 0?s():p()}):p()}loadTargets(t){const e=`${this._url}/api/targets`;this.load(e,t)}loadTargetReleases(t,e){const s=`${this._url}/api/targets/${t}`;this.load(s,e)}loadTarget(t,e,s,a){const i=`${this._url}/api/builds/${e}/${t}`;this.load(i,s,a)}loadTargetHex(t,e,s){const a=`${this._url}${t}`;o.get(a,function(i){r(u.getMessage("buildServerSuccess",[t])),e(i)}).fail(i=>{r(u.getMessage("buildServerFailure",[t,`HTTP ${i.status}`])),s!==void 0&&s()})}getSupportCommands(t,e){const s=`${this._url}/api/support/commands`;o.get(s,function(a){t(a)}).fail(a=>{r(u.getMessage("buildServerFailure",[s,`HTTP ${a.status}`])),e!==void 0&&e()})}submitSupportData(t,e,s){const a=`${this._url}/api/support`;o.ajax({url:a,type:"POST",data:t,contentType:"text/plain",dataType:"text",success:function(i){e(i)}}).fail(i=>{r(u.getMessage("buildServerFailure",[`HTTP ${i.status}`])),s!==void 0&&s()})}requestBuild(t,e,s){const a=`${this._url}/api/builds`;o.ajax({url:a,type:"POST",data:JSON.stringify(t),contentType:"application/json",dataType:"json",success:function(i){e(i)}}).fail(i=>{r(u.getMessage("buildServerFailure",[a,`HTTP ${i.status}`])),s!==void 0&&s()})}requestBuildStatus(t,e,s){const a=`${this._url}/api/builds/${t}/status`;o.get(a,function(i){r(u.getMessage("buildServerSuccess",[a])),e(i)}).fail(i=>{r(u.getMessage("buildServerFailure",[a,`HTTP ${i.status}`])),s!==void 0&&s()})}requestBuildOptions(t,e,s){const a=`${this._url}/api/builds/${t}/json`;o.get(a,function(i){e(i)}).fail(i=>{s!==void 0&&s()})}loadOptions(t,e,s){const a=`${this._url}/api/options/${t}`;this.load(a,e,s)}loadOptionsByBuildKey(t,e,s,a){const i=`${this._url}/api/options/${t}/${e}`;this.load(i,s,a)}loadCommits(t,e,s){const a=`${this._url}/api/releases/${t}/commits`;this.load(a,e,s)}loadConfiguratorRelease(t,e,s){const a=`${this._url}/api/configurator/releases/${t}`;this.load(a,e,s)}loadSponsorTile(t,e,s,a){const i=`${this._url}/api/configurator/sponsors/${t}/${e}`;o.get(i,function(n){s(n)}).fail(n=>{a!==void 0&&a()})}}export{b as B,$ as g,T as s};
