import{G as x,M as r,X as h,$ as e,I as E,T as F,F as l,a3 as O,L as R}from"./DarkTheme-B0yFoytb.js";const A={};A.initialize=function(c){const v=this;x.active_tab_ref=this,x.active_tab="adjustments";function o(){r.send_message(h.MSP_ADJUSTMENT_RANGES,!1,!1,N)}function N(){r.send_message(h.MSP_BOXIDS,!1,!1,w)}function w(){r.send_message(h.MSP_RC,!1,!1,U)}function U(){e("#content").load("./tabs/adjustments.html",G)}r.send_message(h.MSP_BOXNAMES,!1,!1,o);function D(u,s,S){var j,C;const t=e("#tab-adjustments-templates .adjustments .adjustment").clone();e(t).attr("id",`adjustment-${u}`),e(t).data("index",u);const n=e(t).find(".channelInfo .channel"),i=e(n).find("option");i.remove();for(let a=0;a<S;a++){const f=i.clone();f.text(`AUX ${a+1}`),f.val(a),n.append(f)}n.val(s.auxChannelIndex),e(t).find(".functionSelection .function").val(s.adjustmentFunction);const d=e(t).find(".functionSwitchChannel .channel"),p=e(d).find("option");p.remove();let m;for(let a=0;a<S;a++)m=p.clone(),m.text(`AUX ${a+1}`),m.val(a),d.append(m);d.val(s.auxSwitchChannelIndex);const I={min:[900],max:[2100]};let b=[1300,1700];s.range!=null&&(b=[s.range.start,s.range.end]);let _=e(t).find(".range");e(_).find(".channel-slider").noUiSlider({start:b,behaviour:"snap-drag",margin:25,step:25,connect:!0,range:I,format:wNumb({decimals:0})}),e(t).find(".channel-slider").Link("lower").to(e(t).find(".lowerLimitValue")),e(t).find(".channel-slider").Link("upper").to(e(t).find(".upperLimitValue")),e(_).find(".pips-channel-range").noUiSlider_pips({mode:"values",values:[900,1e3,1200,1400,1500,1600,1800,2e3,2100],density:4,stepped:!0});const T=e(t).find(".enable");e(T).data("adjustmentElement",t),e(T).change(function(){const a=e(this).data("adjustmentElement");if(e(this).prop("checked")){e(a).find(":input").prop("disabled",!1),e(a).find(".channel-slider").removeAttr("disabled"),_=e(a).find(".range .channel-slider");const f=e(_).val();if(f[0]==f[1]){const L=[1300,1700];e(_).val(L)}}else e(a).find(":input").prop("disabled",!0),e(a).find(".channel-slider").attr("disabled","disabled");e(this).prop("disabled",!1)});const J=((j=s==null?void 0:s.range)==null?void 0:j.start)!==((C=s==null?void 0:s.range)==null?void 0:C.end);return e(T).prop("checked",J).change(),t}function G(){v.adjust_template();let u=l.RC.active_channels-4;const s=e(".tab-adjustments .adjustments tbody");for(let n=0;n<l.ADJUSTMENT_RANGES.length;n++){const i=D(n,l.ADJUSTMENT_RANGES[n],u);s.append(i)}E.localizePage(),e("a.save").click(function(){const n=l.ADJUSTMENT_RANGES.length;l.ADJUSTMENT_RANGES=[];const i={slotIndex:0,auxChannelIndex:0,range:{start:900,end:900},adjustmentFunction:0,auxSwitchChannelIndex:0};e(".tab-adjustments .adjustments .adjustment").each(function(){const d=e(this);if(e(d).find(".enable").prop("checked")){const p=e(this).find(".range .channel-slider").val(),I={slotIndex:0,auxChannelIndex:parseInt(e(this).find(".channelInfo .channel").val()),range:{start:p[0],end:p[1]},adjustmentFunction:parseInt(e(this).find(".functionSelection .function").val()),auxSwitchChannelIndex:parseInt(e(this).find(".functionSwitchChannel .channel").val())};l.ADJUSTMENT_RANGES.push(I)}else l.ADJUSTMENT_RANGES.push(i)});for(let d=l.ADJUSTMENT_RANGES.length;d<n;d++)l.ADJUSTMENT_RANGES.push(i);O.sendAdjustmentRanges(g);function g(){r.send_message(h.MSP_EEPROM_WRITE,!1,!1,function(){R(E.getMessage("adjustmentsEepromSaved"))})}});function S(n,i){i<900?i=900:i>2100&&(i=2100);const g=(i-900)/1200*100;e(".adjustments .adjustment").each(function(){e(this).find(".channel").val()==n&&e(this).find(".range .marker").css("left",`${g}%`)})}function M(){r.send_message(h.MSP_RC,!1,!1,t)}function t(){u=l.RC.active_channels-4;for(let n=0;n<u;n++)S(n,l.RC.channels[n+4])}t(),x.interval_add("aux_data_pull",M,50),x.content_ready(c)}};A.cleanup=function(c){c&&c()};A.adjust_template=function(){const c=e("#functionSelectionSelect"),v=32;for(let o=0;o<v;o++)c.append(new Option(E.getMessage(`adjustmentsFunction${o}`),o));c.sortSelect(E.getMessage("adjustmentsFunction0"))};F.adjustments=A;export{A as adjustments};
