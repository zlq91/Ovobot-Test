import{T as r,H as V,F as a,a1 as G,G as j,M as q,X as A,$ as e,I as R,a3 as w}from"./DarkTheme-x8aAi6Mp.js";const z={wireMode:!1,directions:["n","e","s","w","u","d"]};z.initialize=function(N,re){let h=null,S=null;const C=".function-";r.led_strip.functions=["i","w","f","a","t","r","c","g","s","b","l","o","y"],r.led_strip.baseFuncs=["c","f","a","l","s","g","r","p","e","u"],r.led_strip.overlays=["t","y","o","b","v","i","w"],V.lt(a.CONFIG.apiVersion,G)&&(r.led_strip.overlays=r.led_strip.overlays.filter(i=>i!=="y")),r.led_strip.wireMode=!1,j.active_tab!="led_strip"&&(j.active_tab="led_strip");function ne(){q.send_message(A.MSP_LED_STRIP_CONFIG,!1,!1,oe)}function oe(){q.send_message(A.MSP_LED_COLORS,!1,!1,se)}function se(){q.send_message(A.MSP_LED_STRIP_MODECOLOR,!1,!1,V.gte(a.CONFIG.apiVersion,G)?te:X)}function te(){q.send_message(A.MSP2_GET_LED_STRIP_CONFIG_VALUES,!1,!1,X)}function X(){e("#content").load("./tabs/led_strip.html",ce)}ne();function Z(){const i=[];return e(".mainGrid .gPoint .wire").each(function(){const n=parseInt(e(this).html());n>=0&&i.push(n)}),i.sort(function(n,l){return n-l}),i}function ce(){R.localizePage();const i=[];let n=0;for(let o=0;o<256;o++)i[n++]='<div class="gPoint"><div class="indicators"><span class="north"></span><span class="south"></span><span class="west"></span><span class="east"></span><span class="up">U</span><span class="down">D</span></div><span class="wire"></span><span class="overlay-t"> </span><span class="overlay-y"> </span><span class="overlay-o"> </span><span class="overlay-b"> </span><span class="overlay-v"> </span><span class="overlay-i"> </span><span class="overlay-w"> </span><span class="overlay-color"> </span></div>';e(".mainGrid").html(i.join("")),e(".tempOutput").on("click",function(){e(this).trigger("select")}),e(".auxSelect").show(),e(".labelSelect").hide();const l=7,u=0;e(".auxSelect").val(B(l,u)),e(".auxSelect").on("change",function(){ie(l,u,e(".auxSelect").val())}),e(".vtxOverlay").show(),e(".funcClear").on("click",function(){e(".gPoint").each(function(){e(this).is(".ui-selected")&&(g(this),e(this).find(".wire").html(""))}),e(".controls button").removeClass("btnOn"),v()}),e(".funcClearAll").on("click",function(){e(".gPoint").each(function(){g(this)}),e(".gPoint .wire").html(""),v(),e(".controls button").removeClass("btnOn")});function g(o){const c=[];r.led_strip.baseFuncs.forEach(function(s){c.push(`function-${s}`)}),r.led_strip.overlays.forEach(function(s){c.push(`function-${s}`)}),r.led_strip.directions.forEach(function(s){c.push(`dir-${s}`)}),e(o).removeClass(c.join(" "))}e(".directions").on("click","button",function(){const o=this;e(".ui-selected").length>0&&(r.led_strip.directions.forEach(function(c){e(o).is(`.dir-${c}`)&&(e(o).is(".btnOn")?(e(o).removeClass("btnOn"),e(".ui-selected").removeClass(`dir-${c}`)):(e(o).addClass("btnOn"),e(".ui-selected").addClass(`dir-${c}`)))}),T(),v())}),e(".mode_colors").on("click","button",function(){const o=this;a.LED_MODE_COLORS.forEach(function(c){if(e(o).is(`.mode_color-${c.mode}-${c.direction}`))if(e(o).is(".btnOn"))e(o).removeClass("btnOn"),e(".ui-selected").removeClass(`mode_color-${c.mode}-${c.direction}`),S=null;else{e(o).addClass("btnOn"),S={mode:c.mode,direction:c.direction};for(let s=0;s<16;s++){const t=`.color-${s}`;s==B(c.mode,c.direction)?(e(t).addClass("btnOn"),h=s,U(s)):e(t).removeClass("btnOn")}}}),e(".mode_colors").each(function(){e(this).children().each(function(){e(this).is(e(o))||e(this).is(".btnOn")&&e(this).removeClass("btnOn")})}),v()});const E=e("div.colorDefineSliders input");E.eq(0).on("input change",function(){P(e(this).val(),0)}),E.eq(1).on("input change",function(){P(e(this).val(),1)}),E.eq(2).on("input change",function(){P(e(this).val(),2)});for(let o=0;o<3;o++)P(E.eq(o).val(),o);const p=e(".colorDefineSliders");e(".colors").on("click","button",function(o){const c=this,s=e(this).parent().find("button");for(let t=0;t<16;t++)s.removeClass("btnOn"),S==null&&e(".ui-selected").removeClass(`color-${t}`),e(c).is(`.color-${t}`)&&(h=t,S==null&&e(".ui-selected").addClass(`color-${t}`));U(h),e(this).addClass("btnOn"),S&&ie(S.mode,S.direction,h),W(),e(".colors").children().each(function(){M(e(this))}),e(".overlay-color").each(function(){M(e(this))}),e(".mode_colors").each(function(){x(e(this))}),e(".special_colors").each(function(){x(e(this))}),v()}),e(".colors").on("dblclick","button",function(){const o=e(this).position(),c=p.width(),s=e(this).width();e(this).offset().left+c/2+s+14>e(window).width()?(p.css("left","auto"),p.css("right",0)):(p.css("left",o.left-c/2+s),p.css("right","auto")),p.css("top",o.top+26),p.show()}),e(".colors").children().on({mouseleave:function(){p.is(":hover")||p.hide()}}),e(".funcWire").on("click",function(){e(this).toggleClass("btnOn"),r.led_strip.wireMode=e(this).hasClass("btnOn"),e(".mainGrid").toggleClass("gridWire")}),e(".funcWireClearSelect").on("click",function(){e(".ui-selected").each(function(){const o=e(this).find(".wire");o.html()!==""&&o.html(""),v()})}),e(".funcWireClear").on("click",function(){e(".gPoint .wire").html(""),v()}),e(".mainGrid").selectable({filter:" > div",stop:function(){const o=[];T();let c;e(".ui-selected").each(function(){const t=Z();let d=0;for(;d<t.length&&t[d]==d;d++);r.led_strip.wireMode&&e(this).find(".wire").html()==""&&d<a.LED_STRIP.length&&e(this).find(".wire").html(d),e(this).find(".wire").text()!=""&&(c=this,r.led_strip.directions.forEach(function(f){const _=`.dir-${f}`;e(c).is(_)&&o.push(_)}),r.led_strip.baseFuncs.forEach(function(f){const _=`.function-${f}`;e(c).is(_)}),r.led_strip.overlays.forEach(function(f){const _=`.function-${f}`;e(c).is(_)}))});const s=c;if(e("select.functionSelect").val(""),r.led_strip.baseFuncs.forEach(function(t){const d=`function-${t}`;e("select.functionSelect").is(`.${d}`)&&e("select.functionSelect").removeClass(d)}),h=0,s){for(let t=0;t<16;t++){const d=`.color-${t}`;e(s).is(d)?(e(d).addClass("btnOn"),h=t):e(d).removeClass("btnOn")}r.led_strip.overlays.forEach(function(t){const d=e(".checkbox").find(`input.function-${t}`),f=e(s).is(C+t);d.is(":checked")!==f&&(d.prop("checked",f),d.trigger("change"),e(".rainbowSlidersDiv").toggle(e(".checkbox.rainbowOverlay").find("input").is(":checked")))}),r.led_strip.baseFuncs.forEach(function(t){e(s).is(C+t)&&(e("select.functionSelect").val(`function-${t}`),e("select.functionSelect").addClass(`function-${t}`))})}v(),U(h),I(),e(".directions button").removeClass("btnOn"),o.forEach(function(t){e(t).addClass("btnOn")})}}),e("#ledStripFunctionSelect").sortSelect(R.getMessage("ledStripFunctionNoneOption")),e(".functionSelect").on("change",function(){T(),Y(),W(),I(),v()}),e("#ledStripModeColorsModeSelect").sortSelect(R.getMessage("ledStripModeColorsModeOrientation")),e(".modeSelect").on("change",function(){const c=Number(e(this).val());e(".mode_colors").find("button").each(function(){for(let s=0;s<6;s++)for(let t=0;t<6;t++)e(this).hasClass(`mode_color-${s}-${t}`)&&(e(this).removeClass(`mode_color-${s}-${t}`),e(this).addClass(`mode_color-${c}-${t}`))}),e(".mode_colors").each(function(){x(e(this))})});function D(o,c){return e(o).is(":checked")?e(".ui-selected").find(".wire").each(function(){if(e(this).text()!=""){const s=e(this).parent();r.led_strip.functions.forEach(function(t){if(s.is(C+t))switch(c){case"t":case"y":case"o":case"s":J(`function-${t}`)&&s.addClass(`function-${c}`);break;case"b":case"i":case"p":case"e":case"u":F(`function-${t}`)&&s.addClass(`function-${c}`);break;case"w":F(`function-${t}`)&&K(`function-${t}`)&&s.addClass(`function-${c}`);break;case"v":F(`function-${t}`)&&Q(`function-${t}`)&&s.addClass(`function-${c}`);break}})}}):e(".ui-selected").removeClass(`function-${c}`),e(o).is(":checked")}e(".checkbox").on("change",function(o){if(o.originalEvent){const c=e(this).find("input");if(c.is(".function-o")){const s=e(".checkbox .function-b");s.is(":checked")&&(s.prop("checked",!1),s.trigger("change"),D(s,"b"))}else if(c.is(".function-b")){const s=e(".checkbox .function-o");e(".checkbox .function-o").is(":checked")&&(s.prop("checked",!1),s.trigger("change"),D(s,"o"))}c.is(".function-y")&&e(".rainbowSlidersDiv").toggle(c.is(":checked")),e(".ui-selected").length>0&&(r.led_strip.overlays.forEach(function(s){e(c).is(C+s)&&D(c,s)}),T(),v(),I())}}),e(".mainGrid").disableSelection(),e(".gPoint").each(function(){const o=e(this).index()+1,c=Math.ceil(o/16)-1;let s=o/16%1*16-1;s<0&&(s=15);const t=le(s,c);if(!t)return;const d=t.index,f=t.led;if(!(f.functions[0]=="c"&&f.functions.length==1&&f.directions.length==0&&f.color==0&&f.x==0&&f.y==0)){e(this).find(".wire").html(d);for(let _=0;_<f.functions.length;_++)e(this).addClass(`function-${f.functions[_]}`);for(let _=0;_<f.directions.length;_++)e(this).addClass(`dir-${f.directions[_]}`);e(this).addClass(`color-${f.color}`)}}),e("div.brightnessSlider input").first().prop("value",a.LED_CONFIG_VALUES.brightness),e("div.brightnessSlider label").first().text(e("div.brightnessSlider input").first().val()),e("div.rainbowDeltaSlider input").first().prop("value",a.LED_CONFIG_VALUES.rainbow_delta),e("div.rainbowDeltaSlider label").first().text(e("div.rainbowDeltaSlider input").first().val()),e("div.rainbowFreqSlider input").first().prop("value",a.LED_CONFIG_VALUES.rainbow_freq),e("div.rainbowFreqSlider label").first().text(e("div.rainbowFreqSlider input").first().val());let O=[],$=!1;e("div.brightnessSlider input").on("input",function(){const o=e(this).val();O.push(o),$||($=setTimeout(function(){a.LED_CONFIG_VALUES.brightness=O.pop(),w.sendLedStripConfigValues(),O=[],$=!1},10)),e("div.brightnessSlider label").first().text(o)});let y=[],L=!1;e("div.rainbowDeltaSlider input").on("input",function(){const o=e(this).val();y.push(o),L||(L=setTimeout(function(){a.LED_CONFIG_VALUES.rainbow_delta=y.pop(),w.sendLedStripConfigValues(),y=[],L=!1},10)),e("div.rainbowDeltaSlider label").first().text(o)});let k=[],b=!1;if(e("div.rainbowFreqSlider input").on("input",function(){const o=e(this).val();k.push(o),b||(b=setTimeout(function(){a.LED_CONFIG_VALUES.rainbow_freq=k.pop(),w.sendLedStripConfigValues(),k=[],b=!1},10)),e("div.rainbowFreqSlider label").first().text(o)}),e("a.save").on("click",function(){const o=e("a.save"),c=o.text();o.html(R.getMessage("buttonSaving")).addClass("disabled"),w.sendLedStripConfig(s);function s(){w.sendLedStripColors(t)}function t(){w.sendLedStripModeColors(d)}function d(){w.writeConfiguration(!1,f)}function f(){setTimeout(()=>{o.html(R.getMessage("buttonSaved")),setTimeout(()=>{o.html(c).removeClass("disabled")},1500)},1500)}}),p.hide(),Y(),W(),I(),v(),e(window).width()<575){const o=e(".tab_title").width()/496;e(".mainGrid, .gridSections").css("zoom",o)}j.content_ready(N)}function le(i,n){for(let l=0;l<a.LED_STRIP.length;l++){const u=a.LED_STRIP[l];if(u.x==i&&u.y==n)return{index:l,led:u}}}function v(){const i=a.LED_STRIP.length;a.LED_STRIP=[],e(".gPoint").each(function(){if(e(this).is('[class*="function"]')){const g=e(this).index()+1,E=Math.ceil(g/16)-1;let p=g/16%1*16-1;p<0&&(p=15);const D=e(this).find(".wire").html();let O="",$="",y=0;const L=this,k=e(this).attr("class").match(/(^|\s)color-([0-9]+)(\s|$)/);if(k&&(y=k[2]),r.led_strip.baseFuncs.forEach(function(b){e(L).is(C+b)&&(O+=b)}),r.led_strip.overlays.forEach(function(b){e(L).is(C+b)&&(O+=b)}),r.led_strip.directions.forEach(function(b){e(L).is(`.dir-${b}`)&&($+=b)}),D!=""){const b={x:p,y:E,directions:$,functions:O,color:y};a.LED_STRIP[D]=b}}});const n={x:0,y:0,directions:"",functions:""};for(let g=0;g<i;g++)a.LED_STRIP[g]||(a.LED_STRIP[g]=n);const l=Z(),u=a.LED_STRIP.length-l.length;e(".wires-remaining div").html(u)}function x(i){i.find('[class*="mode_color"]').each(function(){let n=0,l=0;const u=e(this).attr("class").match(/(^|\s)mode_color-([0-9]+)-([0-9]+)(\s|$)/);u&&(n=Number(u[2]),l=Number(u[3]),e(this).css("background-color",H(a.LED_COLORS[B(n,l)])))})}function M(i){if(i.is('[class*="color"]')){let n=0;const l=i.attr("class").match(/(^|\s)color-([0-9]+)(\s|$)/);l&&(n=l[2],i.css("background-color",H(a.LED_COLORS[n])))}}function J(i){switch(i){case"function-c":case"function-a":case"function-f":return!0}return!1}function F(i){switch(i){case"":case"function-c":case"function-a":case"function-f":case"function-p":case"function-e":case"function-u":case"function-s":case"function-l":case"function-r":case"function-y":case"function-o":case"function-b":case"function-g":return!0}return!1}function ae(i){if(V.gte(a.CONFIG.apiVersion,G))switch(i){case"function-c":case"function-a":case"function-f":return!0}return!1}function K(i){switch(i){case"function-l":case"function-s":case"function-g":return!1;case"function-r":case"function-b":default:return!0}}function Q(i){switch(i){case"function-v":case"function-c":case"function-a":case"function-f":return!0;default:return!1}}function I(){const i=e("select.functionSelect").val();switch(e("select.functionSelect").addClass(i),e(".overlays").toggle(F(i)),e(".modifiers").toggle(J(i)),e(".rainbowOverlay").toggle(ae(i)),e(".warningOverlay").toggle(K(i)),e(".vtxOverlay").toggle(Q(i)),e(".brightnessSliderDiv").toggle(V.gte(a.CONFIG.apiVersion,G)),i==="function-f"?e(".mode_colors").show():e(".mode_colors").hide(),e(".special_colors").show(),e(".mode_color-6-0").hide(),e(".mode_color-6-1").hide(),e(".mode_color-6-2").hide(),e(".mode_color-6-3").hide(),e(".mode_color-6-4").hide(),e(".mode_color-6-5").hide(),e(".mode_color-6-6").hide(),e(".mode_color-6-7").hide(),i){case"":case"function-f":e(".modeSelect").show(),e(".special_colors").hide();case"function-l":e(".special_colors").hide();break;case"function-g":e(".modeSelect").show(),e(".mode_color-6-5").show(),e(".mode_color-6-6").show(),e(".mode_color-6-7").show();break;case"function-b":e(".mode_color-6-4").show();break;case"function-a":e(".modeSelect").hide(),e(".mode_color-6-0").show(),e(".mode_color-6-1").show();break;case"function-r":default:e(".special_colors").hide();break}}function Y(){const i=e("select.functionSelect").val();r.led_strip.baseFuncs.forEach(function(n){i==`function-${n}`?(e("select.functionSelect").addClass(`function-${n}`),e(".ui-selected").find(".wire").each(function(){e(this).text()!=""&&e(this).parent().addClass(`function-${n}`)}),ee(n)):(e("select.functionSelect").removeClass(`function-${n}`),e(".ui-selected").removeClass(`function-${n}`)),i==""&&ee(i)})}function ee(i){(i=="r"||i=="")&&(m(i,"y"),m(i,"o"),m(i,"b"),m(i,"t")),(i=="l"||i=="g"||i=="s")&&(m(i,"w"),m(i,"v"),m(i,"t"),m(i,"y"),m(i,"o"),m(i,"b"))}function m(i,n){e(`input.function-${n}`).prop("checked",!1),e(`input.function-${n}`).trigger("change"),e(".ui-selected").each(function(){(i===""||e(this).is(C+i))&&e(this).removeClass(`function-${n}`)})}function P(i,n){let l=!1;i=Number(i);const u=`.color-${h}`;if(e(u).hasClass("btnOn"))switch(n){case 0:a.LED_COLORS[h].h!=i&&(a.LED_COLORS[h].h=i,e(".colorDefineSliderValue.Hvalue").text(a.LED_COLORS[h].h),l=!0);break;case 1:a.LED_COLORS[h].s!=i&&(a.LED_COLORS[h].s=i,e(".colorDefineSliderValue.Svalue").text(a.LED_COLORS[h].s),l=!0);break;case 2:a.LED_COLORS[h].v!=i&&(a.LED_COLORS[h].v=i,e(".colorDefineSliderValue.Vvalue").text(a.LED_COLORS[h].v),l=!0);break}e(".colors").children().each(function(){M(e(this))}),e(".overlay-color").each(function(){M(e(this))}),e(".mode_colors").each(function(){x(e(this))}),e(".special_colors").each(function(){x(e(this))}),l&&v()}function W(){e(".gPoint").each(function(){if(e(this).is(".function-c")||e(this).is(".function-r")||e(this).is(".function-b")||e(this).is(".function-u")){e(this).find(".overlay-color").show();for(let i=0;i<16;i++){const n=`color-${i}`;e(this).is(`.${n}`)?(e(this).find(".overlay-color").addClass(n),e(this).find(".overlay-color").css("background-color",H(a.LED_COLORS[i]))):e(this).find(".overlay-color").is(`.${n}`)&&e(this).find(".overlay-color").removeClass(n)}}else e(this).find(".overlay-color").hide()})}function U(i){const n=e("div.colorDefineSliders input");let l=!1;a.LED_COLORS[i]&&(a.LED_COLORS[i].h!=Number(n.eq(0).val())&&(n.eq(0).val(a.LED_COLORS[i].h),e(".colorDefineSliderValue.Hvalue").text(a.LED_COLORS[i].h),l=!0),a.LED_COLORS[i].s!=Number(n.eq(1).val())&&(n.eq(1).val(a.LED_COLORS[i].s),e(".colorDefineSliderValue.Svalue").text(a.LED_COLORS[i].s),l=!0),a.LED_COLORS[i].v!=Number(n.eq(2).val())&&(n.eq(2).val(a.LED_COLORS[i].v),e(".colorDefineSliderValue.Vvalue").text(a.LED_COLORS[i].v),l=!0),l&&n.trigger("input"))}function H(i){if(i==null)return"";let n={h:Number(i.h),s:Number(i.s),v:Number(i.v)};if(n.s==0&&n.v==0)return"";n={h:n.h,s:1-n.s/255,v:n.v/255};const l={h:0,s:0};return l.h=n.h,l.l=(2-n.s)*n.v/2,l.l&&l.l<1&&(l.l<.5?l.s=n.s*n.v/(l.l*2):l.s=n.s*n.v/(2-l.l*2)),`hsl(${l.h},${l.s*100}%,${l.l*100}%)`}function B(i,n){for(const l of a.LED_MODE_COLORS)if(l.mode===i&&l.direction===n)return l.color;return 3}function ie(i,n,l){for(const u of a.LED_MODE_COLORS)if(u.mode===i&&u.direction===n)return u.color=l,1;return 0}function T(){S=null,e(".mode_colors").each(function(){e(this).children().each(function(){e(this).is(".btnOn")&&e(this).removeClass("btnOn")})})}};z.cleanup=function(N){N&&N()};r.led_strip=z;export{z as led_strip};
